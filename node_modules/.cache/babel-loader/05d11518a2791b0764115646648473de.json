{"ast":null,"code":"var _jsxFileName = \"/Users/lchen/Documents/CODE/vizCode/air-pollution/src/App.js\";\nimport React, { useState, useMemo } from \"react\";\nimport \"antd/dist/antd.css\";\nimport { StaticMap } from \"react-map-gl\";\nimport DeckGL from \"@deck.gl/react\";\nimport { HeatmapLayer } from \"@deck.gl/aggregation-layers\";\nimport { AmbientLight, PointLight, LightingEffect } from \"@deck.gl/core\";\nimport { HexagonLayer } from \"@deck.gl/aggregation-layers\";\nimport { DataFilterExtension } from \"@deck.gl/extensions\";\nimport { Menu, Dropdown, Button, message, Slider } from \"antd\";\nimport { DownOutlined } from \"@ant-design/icons\";\nimport { Typography } from \"antd\";\nimport { Statistic } from \"antd\";\nimport { Divider } from \"antd\";\nimport RangeInput from \"./range-input\";\nconst {\n  Title,\n  Text\n} = Typography;\nimport Charts from './charts'; // Set your mapbox access token here\n\nconst MAPBOX_ACCESS_TOKEN = \"pk.eyJ1IjoidmVyYTFrIiwiYSI6ImNrZjZ5bWZ3YzBhNDEycWxiZHBycDFrZnoifQ.hVFCurngFTtg2R0ivt-zyg\"; // eslint-disable-line\n\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  intensity: 1.0\n});\nconst pointLight1 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-0.144528, 49.739968, 80000]\n});\nconst pointLight2 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-3.807751, 54.104682, 8000]\n});\nconst lightingEffect = new LightingEffect({\n  ambientLight,\n  pointLight1,\n  pointLight2\n});\nconst material = {\n  ambient: 0.64,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [51, 51, 51]\n};\nconst INITIAL_VIEW_STATE = {\n  longitude: -1.415727,\n  latitude: 52.232395,\n  zoom: 6.6,\n  minZoom: 5,\n  maxZoom: 15,\n  pitch: 40.5,\n  bearing: -27\n};\nexport const colorRange = [[1, 152, 189], [73, 227, 206], [216, 254, 181], [254, 237, 177], [254, 173, 84], [209, 55, 78]];\nexport const heatmapColorRange = [[255, 255, 178], [254, 217, 118], [254, 178, 76], [253, 141, 60], [240, 59, 32], [189, 0, 38]];\n\nfunction getTooltip({\n  object\n}) {\n  if (!object) {\n    return null;\n  }\n\n  const lat = object.position[1];\n  const lng = object.position[0];\n  const count = object.points.length;\n  return `\\\n    Latitude: ${Number.isFinite(lat) ? lat.toFixed(6) : \"\"}\n    Longitude: ${Number.isFinite(lng) ? lng.toFixed(6) : \"\"}\n    Number of Covid-19 Infections: ${count} `;\n}\n\nfunction getCovidInfections(data) {\n  return data.length;\n}\n\nconst dataFilter = new DataFilterExtension({\n  filterSize: 1,\n  fp64: false\n});\n\nfunction getTimeRange(data) {\n  if (!data) {\n    return null;\n  }\n\n  return data.reduce((range, d) => {\n    const t = d.DATE;\n    range[0] = Math.min(range[0], t);\n    range[1] = Math.max(range[1], t);\n    return range;\n  }, [Infinity, -Infinity]);\n}\n\nfunction formatLabel(t) {\n  const date = new Date(t);\n  return `${date.getUTCFullYear()}/${date.getUTCMonth() + 1}/${date.getUTCDate()}`;\n}\n\nexport default function App({\n  intensity = 1,\n  threshold = 0.1,\n  radiusPixels = 30,\n  mapStyle = \"mapbox://styles/mapbox/dark-v9\",\n  // upperPercentile = 100,\n  coverage = 1\n}) {\n  const [vis, setVis] = useState(\"Hexagon\");\n  const [data, setData] = useState(crimeData);\n  const [percentile, setPercentile] = useState([0, 100]);\n  const [filter, setFilter] = useState(null);\n  const timeRange = useMemo(() => getTimeRange(data), [data]);\n  const filterValue = filter || timeRange;\n  const [crimeType, setCrimeType] = useState(null);\n  const uniqueCrimeTypes = [...new Set(crimeData.map(crime => crime.TYPE))];\n  const crimeTypeMenu = /*#__PURE__*/React.createElement(Menu, {\n    onClick: handleMenuClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 5\n    }\n  }, uniqueCrimeTypes.map((type, index) => /*#__PURE__*/React.createElement(Menu.Item, {\n    key: index,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 9\n    }\n  }, type)), /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"ALL\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }\n  }, \"All Crimes\"));\n\n  function handleMenuClick(e) {\n    if (e.key === \"ALL\") {\n      setCrimeType(\"ALL\");\n      setData(crimeData);\n      message.success(\"Showing all crimes\", 1);\n    } else {\n      setCrimeType(uniqueCrimeTypes[e.key]);\n      setData(crimeData.filter(crime => crime.TYPE === uniqueCrimeTypes[e.key]));\n      message.success(\"Selected \" + uniqueCrimeTypes[e.key], 1);\n    }\n  }\n\n  function onSliderChange(value) {\n    setPercentile(value);\n  }\n\n  const vizTypeMenu = /*#__PURE__*/React.createElement(Menu, {\n    onClick: handleVizChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"Hexagon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }, \"Hexagon\"), /*#__PURE__*/React.createElement(Menu.Item, {\n    key: \"Heatmap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 7\n    }\n  }, \"Heatmap\"));\n\n  function handleVizChange(e) {\n    setVizType(e.key);\n    message.success(\"Selected \" + e.key, 1);\n  }\n\n  const layers = [data && vizType === \"Heatmap\" ? new HeatmapLayer({\n    data,\n    colorRange: heatmapColorRange,\n    id: \"heatmp-layer\",\n    pickable: true,\n    getPosition: d => [d.COORDINATES[1], d.COORDINATES[0]],\n    getFilterValue: d => d.DATE,\n    filterRange: [filterValue[0], filterValue[1]],\n    filterSoftRange: [filterValue[0] * 0.9 + filterValue[1] * 0.1, filterValue[0] * 0.1 + filterValue[1] * 0.9],\n    extensions: [dataFilter],\n    upperPercentile: percentile[1],\n    lowerPercentile: percentile[0],\n    radiusPixels,\n    intensity,\n    threshold\n  }) : vizType === \"Hexagon\" ? new HexagonLayer({\n    id: \"hexagon\",\n    colorRange,\n    coverage,\n    data,\n    elevationRange: [0, 200],\n    elevationScale: data && data.length ? 50 : 0,\n    extruded: true,\n    getPosition: d => [d.COORDINATES[1], d.COORDINATES[0]],\n    pickable: true,\n    radius: 100,\n    upperPercentile: percentile[1],\n    lowerPercentile: percentile[0],\n    material,\n    transitions: {\n      elevationScale: 1000\n    }\n  }) : null];\n  const MS_PER_DAY = 8.64e7;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container\",\n    style: {\n      height: \"100vh\",\n      width: \"100vw\",\n      padding: 0,\n      margin: 0\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      backgroundColor: \"white\",\n      zIndex: \"1000\",\n      position: \"absolute\",\n      marginTop: \"1.0%\",\n      right: \"1.5%\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      height: \"470px\",\n      width: \"340px\",\n      paddingLeft: \"20px\",\n      paddingRight: \"20px\",\n      paddingTop: \"12px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Title, {\n    level: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 9\n    }\n  }, \"Atlanta Crime Dashboard\"), /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 9\n    }\n  }, \"All reported crimes in Atlanta in 2019.\"), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      justifyContent: \"space-evenly\",\n      paddingTop: \"16px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 9\n    }\n  }, vizType === \"Hexagon\" ? colorRange.map(color => /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: \"16.6667%\",\n      height: \"18px\",\n      backgroundColor: `rgb(${color[0]}, ${color[1]}, ${color[2]})`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 17\n    }\n  })) : heatmapColorRange.map(color => /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      width: \"16.6667%\",\n      height: \"18px\",\n      backgroundColor: `rgb(${color[0]}, ${color[1]}, ${color[2]})`\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 17\n    }\n  }))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      justifyContent: \"space-between\",\n      paddingTop: \"6px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 287,\n      columnNumber: 11\n    }\n  }, \"Fewer crimes\"), /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 11\n    }\n  }, \"More crimes\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: \"12px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 11\n    }\n  }, \"Data source:\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"http://opendata.atlantapd.org/Default.aspx\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 13\n    }\n  }, \"APD Open Data Portal\"))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: \"12px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Statistic, {\n    title: \"Crimes\",\n    value: getCrimeCount(data),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 11\n    }\n  })), vizType === \"Hexagon\" ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: \"12px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 13\n    }\n  }, \"Filter by percentile\"), /*#__PURE__*/React.createElement(Slider, {\n    range: true // tooltipVisible\n    ,\n    defaultValue: [0, 100],\n    marks: {\n      0: \"0\",\n      100: \"100\"\n    },\n    onAfterChange: onSliderChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 13\n    }\n  })) : null, /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"row\",\n      alignContent: \"center\",\n      justifyContent: \"space-around\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Dropdown, {\n    overlay: crimeTypeMenu,\n    placement: \"bottomRight\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 13\n    }\n  }, crimeType ? crimeType : \"Crime type\", \" \", /*#__PURE__*/React.createElement(DownOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 54\n    }\n  }))), /*#__PURE__*/React.createElement(Dropdown, {\n    overlay: vizTypeMenu,\n    placement: \"bottomRight\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 13\n    }\n  }, vizType ? vizType : \"Choose visualization type\", \" \", /*#__PURE__*/React.createElement(DownOutlined, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 65\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      paddingTop: \"24px\",\n      paddingLeft: \"60%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 11\n    }\n  }, \"View Code:\", \" \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"https://github.com/forensx/atlanta_pd_dashboard\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 13\n    }\n  }, \"GitHub\")))), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      zIndex: \"-1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(DeckGL, {\n    effects: [lightingEffect],\n    initialViewState: INITIAL_VIEW_STATE,\n    controller: true,\n    layers: layers,\n    getTooltip: getTooltip,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(StaticMap, {\n    reuseMaps: true,\n    mapStyle: mapStyle,\n    preventStyleDiffing: true,\n    mapboxApiAccessToken: MAPBOX_ACCESS_TOKEN,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 11\n    }\n  })), timeRange && vizType === \"Heatmap\" && /*#__PURE__*/React.createElement(RangeInput, {\n    min: timeRange[0],\n    max: timeRange[1],\n    value: filterValue,\n    formatLabel: formatLabel,\n    animationSpeed: MS_PER_DAY,\n    onChange: setFilter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 11\n    }\n  })));\n}","map":{"version":3,"sources":["/Users/lchen/Documents/CODE/vizCode/air-pollution/src/App.js"],"names":["React","useState","useMemo","StaticMap","DeckGL","HeatmapLayer","AmbientLight","PointLight","LightingEffect","HexagonLayer","DataFilterExtension","Menu","Dropdown","Button","message","Slider","DownOutlined","Typography","Statistic","Divider","RangeInput","Title","Text","Charts","MAPBOX_ACCESS_TOKEN","ambientLight","color","intensity","pointLight1","position","pointLight2","lightingEffect","material","ambient","diffuse","shininess","specularColor","INITIAL_VIEW_STATE","longitude","latitude","zoom","minZoom","maxZoom","pitch","bearing","colorRange","heatmapColorRange","getTooltip","object","lat","lng","count","points","length","Number","isFinite","toFixed","getCovidInfections","data","dataFilter","filterSize","fp64","getTimeRange","reduce","range","d","t","DATE","Math","min","max","Infinity","formatLabel","date","Date","getUTCFullYear","getUTCMonth","getUTCDate","App","threshold","radiusPixels","mapStyle","coverage","vis","setVis","setData","crimeData","percentile","setPercentile","filter","setFilter","timeRange","filterValue","crimeType","setCrimeType","uniqueCrimeTypes","Set","map","crime","TYPE","crimeTypeMenu","handleMenuClick","type","index","e","key","success","onSliderChange","value","vizTypeMenu","handleVizChange","setVizType","layers","vizType","id","pickable","getPosition","COORDINATES","getFilterValue","filterRange","filterSoftRange","extensions","upperPercentile","lowerPercentile","elevationRange","elevationScale","extruded","radius","transitions","MS_PER_DAY","height","width","padding","margin","backgroundColor","zIndex","marginTop","right","display","flexDirection","paddingLeft","paddingRight","paddingTop","alignItems","justifyContent","getCrimeCount","alignContent"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,OAA1B,QAAyC,OAAzC;AACA,OAAO,oBAAP;AACA,SAASC,SAAT,QAA0B,cAA1B;AACA,OAAOC,MAAP,MAAmB,gBAAnB;AACA,SAASC,YAAT,QAA6B,6BAA7B;AACA,SAASC,YAAT,EAAuBC,UAAvB,EAAmCC,cAAnC,QAAyD,eAAzD;AACA,SAASC,YAAT,QAA6B,6BAA7B;AACA,SAASC,mBAAT,QAAoC,qBAApC;AACA,SAASC,IAAT,EAAeC,QAAf,EAAyBC,MAAzB,EAAiCC,OAAjC,EAA0CC,MAA1C,QAAwD,MAAxD;AACA,SAASC,YAAT,QAA6B,mBAA7B;AACA,SAASC,UAAT,QAA2B,MAA3B;AACA,SAASC,SAAT,QAA0B,MAA1B;AACA,SAASC,OAAT,QAAwB,MAAxB;AACA,OAAOC,UAAP,MAAuB,eAAvB;AACA,MAAM;AAAEC,EAAAA,KAAF;AAASC,EAAAA;AAAT,IAAkBL,UAAxB;AACA,OAAOM,MAAP,MAAmB,UAAnB,C,CAEA;;AACA,MAAMC,mBAAmB,GACvB,0FADF,C,CAC8F;;AAE9F,MAAMC,YAAY,GAAG,IAAInB,YAAJ,CAAiB;AACpCoB,EAAAA,KAAK,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAD6B;AAEpCC,EAAAA,SAAS,EAAE;AAFyB,CAAjB,CAArB;AAKA,MAAMC,WAAW,GAAG,IAAIrB,UAAJ,CAAe;AACjCmB,EAAAA,KAAK,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAD0B;AAEjCC,EAAAA,SAAS,EAAE,GAFsB;AAGjCE,EAAAA,QAAQ,EAAE,CAAC,CAAC,QAAF,EAAY,SAAZ,EAAuB,KAAvB;AAHuB,CAAf,CAApB;AAMA,MAAMC,WAAW,GAAG,IAAIvB,UAAJ,CAAe;AACjCmB,EAAAA,KAAK,EAAE,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAD0B;AAEjCC,EAAAA,SAAS,EAAE,GAFsB;AAGjCE,EAAAA,QAAQ,EAAE,CAAC,CAAC,QAAF,EAAY,SAAZ,EAAuB,IAAvB;AAHuB,CAAf,CAApB;AAMA,MAAME,cAAc,GAAG,IAAIvB,cAAJ,CAAmB;AAACiB,EAAAA,YAAD;AAAeG,EAAAA,WAAf;AAA4BE,EAAAA;AAA5B,CAAnB,CAAvB;AAEA,MAAME,QAAQ,GAAG;AACfC,EAAAA,OAAO,EAAE,IADM;AAEfC,EAAAA,OAAO,EAAE,GAFM;AAGfC,EAAAA,SAAS,EAAE,EAHI;AAIfC,EAAAA,aAAa,EAAE,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT;AAJA,CAAjB;AAOA,MAAMC,kBAAkB,GAAG;AACzBC,EAAAA,SAAS,EAAE,CAAC,QADa;AAEzBC,EAAAA,QAAQ,EAAE,SAFe;AAGzBC,EAAAA,IAAI,EAAE,GAHmB;AAIzBC,EAAAA,OAAO,EAAE,CAJgB;AAKzBC,EAAAA,OAAO,EAAE,EALgB;AAMzBC,EAAAA,KAAK,EAAE,IANkB;AAOzBC,EAAAA,OAAO,EAAE,CAAC;AAPe,CAA3B;AAUA,OAAO,MAAMC,UAAU,GAAG,CACxB,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,CADwB,EAExB,CAAC,EAAD,EAAK,GAAL,EAAU,GAAV,CAFwB,EAGxB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAHwB,EAIxB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAJwB,EAKxB,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,CALwB,EAMxB,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,CANwB,CAAnB;AASP,OAAO,MAAMC,iBAAiB,GAAG,CAC/B,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAD+B,EAE/B,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,CAF+B,EAG/B,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,CAH+B,EAI/B,CAAC,GAAD,EAAM,GAAN,EAAW,EAAX,CAJ+B,EAK/B,CAAC,GAAD,EAAM,EAAN,EAAU,EAAV,CAL+B,EAM/B,CAAC,GAAD,EAAM,CAAN,EAAS,EAAT,CAN+B,CAA1B;;AASP,SAASC,UAAT,CAAoB;AAAEC,EAAAA;AAAF,CAApB,EAAgC;AAC9B,MAAI,CAACA,MAAL,EAAa;AACX,WAAO,IAAP;AACD;;AACD,QAAMC,GAAG,GAAGD,MAAM,CAACnB,QAAP,CAAgB,CAAhB,CAAZ;AACA,QAAMqB,GAAG,GAAGF,MAAM,CAACnB,QAAP,CAAgB,CAAhB,CAAZ;AACA,QAAMsB,KAAK,GAAGH,MAAM,CAACI,MAAP,CAAcC,MAA5B;AAEA,SAAQ;gBACMC,MAAM,CAACC,QAAP,CAAgBN,GAAhB,IAAuBA,GAAG,CAACO,OAAJ,CAAY,CAAZ,CAAvB,GAAwC,EAAG;iBAC1CF,MAAM,CAACC,QAAP,CAAgBL,GAAhB,IAAuBA,GAAG,CAACM,OAAJ,CAAY,CAAZ,CAAvB,GAAwC,EAAG;qCACvBL,KAAM,GAHzC;AAID;;AAED,SAASM,kBAAT,CAA4BC,IAA5B,EAAkC;AAChC,SAAOA,IAAI,CAACL,MAAZ;AACD;;AAED,MAAMM,UAAU,GAAG,IAAIjD,mBAAJ,CAAwB;AACzCkD,EAAAA,UAAU,EAAE,CAD6B;AAEzCC,EAAAA,IAAI,EAAE;AAFmC,CAAxB,CAAnB;;AAKA,SAASC,YAAT,CAAsBJ,IAAtB,EAA4B;AAC1B,MAAI,CAACA,IAAL,EAAW;AACT,WAAO,IAAP;AACD;;AACD,SAAOA,IAAI,CAACK,MAAL,CACL,CAACC,KAAD,EAAQC,CAAR,KAAc;AACZ,UAAMC,CAAC,GAAGD,CAAC,CAACE,IAAZ;AAEAH,IAAAA,KAAK,CAAC,CAAD,CAAL,GAAWI,IAAI,CAACC,GAAL,CAASL,KAAK,CAAC,CAAD,CAAd,EAAmBE,CAAnB,CAAX;AACAF,IAAAA,KAAK,CAAC,CAAD,CAAL,GAAWI,IAAI,CAACE,GAAL,CAASN,KAAK,CAAC,CAAD,CAAd,EAAmBE,CAAnB,CAAX;AACA,WAAOF,KAAP;AACD,GAPI,EAQL,CAACO,QAAD,EAAW,CAACA,QAAZ,CARK,CAAP;AAUD;;AAED,SAASC,WAAT,CAAqBN,CAArB,EAAwB;AACtB,QAAMO,IAAI,GAAG,IAAIC,IAAJ,CAASR,CAAT,CAAb;AACA,SAAQ,GAAEO,IAAI,CAACE,cAAL,EAAsB,IAC9BF,IAAI,CAACG,WAAL,KAAqB,CACtB,IAAGH,IAAI,CAACI,UAAL,EAAkB,EAFtB;AAGD;;AAED,eAAe,SAASC,GAAT,CAAa;AAC1BnD,EAAAA,SAAS,GAAG,CADc;AAE1BoD,EAAAA,SAAS,GAAG,GAFc;AAG1BC,EAAAA,YAAY,GAAG,EAHW;AAI1BC,EAAAA,QAAQ,GAAG,gCAJe;AAK1B;AACAC,EAAAA,QAAQ,GAAG;AANe,CAAb,EAOZ;AACD,QAAM,CAACC,GAAD,EAAMC,MAAN,IAAgBnF,QAAQ,CAAC,SAAD,CAA9B;AACA,QAAM,CAACyD,IAAD,EAAO2B,OAAP,IAAkBpF,QAAQ,CAACqF,SAAD,CAAhC;AAEA,QAAM,CAACC,UAAD,EAAaC,aAAb,IAA8BvF,QAAQ,CAAC,CAAC,CAAD,EAAI,GAAJ,CAAD,CAA5C;AAEA,QAAM,CAACwF,MAAD,EAASC,SAAT,IAAsBzF,QAAQ,CAAC,IAAD,CAApC;AACA,QAAM0F,SAAS,GAAGzF,OAAO,CAAC,MAAM4D,YAAY,CAACJ,IAAD,CAAnB,EAA2B,CAACA,IAAD,CAA3B,CAAzB;AACA,QAAMkC,WAAW,GAAGH,MAAM,IAAIE,SAA9B;AAEA,QAAM,CAACE,SAAD,EAAYC,YAAZ,IAA4B7F,QAAQ,CAAC,IAAD,CAA1C;AACA,QAAM8F,gBAAgB,GAAG,CAAC,GAAG,IAAIC,GAAJ,CAAQV,SAAS,CAACW,GAAV,CAAeC,KAAD,IAAWA,KAAK,CAACC,IAA/B,CAAR,CAAJ,CAAzB;AACA,QAAMC,aAAa,gBACjB,oBAAC,IAAD;AAAM,IAAA,OAAO,EAAEC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGN,gBAAgB,CAACE,GAAjB,CAAqB,CAACK,IAAD,EAAOC,KAAP,kBACpB,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAEA,KAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAwBD,IAAxB,CADD,CADH,eAIE,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAJF,CADF;;AASA,WAASD,eAAT,CAAyBG,CAAzB,EAA4B;AAC1B,QAAIA,CAAC,CAACC,GAAF,KAAU,KAAd,EAAqB;AACnBX,MAAAA,YAAY,CAAC,KAAD,CAAZ;AACAT,MAAAA,OAAO,CAACC,SAAD,CAAP;AACAxE,MAAAA,OAAO,CAAC4F,OAAR,CAAgB,oBAAhB,EAAsC,CAAtC;AACD,KAJD,MAIO;AACLZ,MAAAA,YAAY,CAACC,gBAAgB,CAACS,CAAC,CAACC,GAAH,CAAjB,CAAZ;AACApB,MAAAA,OAAO,CACLC,SAAS,CAACG,MAAV,CAAkBS,KAAD,IAAWA,KAAK,CAACC,IAAN,KAAeJ,gBAAgB,CAACS,CAAC,CAACC,GAAH,CAA3D,CADK,CAAP;AAGA3F,MAAAA,OAAO,CAAC4F,OAAR,CAAgB,cAAcX,gBAAgB,CAACS,CAAC,CAACC,GAAH,CAA9C,EAAuD,CAAvD;AACD;AACF;;AAED,WAASE,cAAT,CAAwBC,KAAxB,EAA+B;AAC7BpB,IAAAA,aAAa,CAACoB,KAAD,CAAb;AACD;;AAED,QAAMC,WAAW,gBACf,oBAAC,IAAD;AAAM,IAAA,OAAO,EAAEC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,eAEE,oBAAC,IAAD,CAAM,IAAN;AAAW,IAAA,GAAG,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAFF,CADF;;AAOA,WAASA,eAAT,CAAyBN,CAAzB,EAA4B;AAC1BO,IAAAA,UAAU,CAACP,CAAC,CAACC,GAAH,CAAV;AACA3F,IAAAA,OAAO,CAAC4F,OAAR,CAAgB,cAAcF,CAAC,CAACC,GAAhC,EAAqC,CAArC;AACD;;AAED,QAAMO,MAAM,GAAG,CACbtD,IAAI,IAAIuD,OAAO,KAAK,SAApB,GACI,IAAI5G,YAAJ,CAAiB;AACfqD,IAAAA,IADe;AAEfb,IAAAA,UAAU,EAAEC,iBAFG;AAGfoE,IAAAA,EAAE,EAAE,cAHW;AAIfC,IAAAA,QAAQ,EAAE,IAJK;AAKfC,IAAAA,WAAW,EAAGnD,CAAD,IAAO,CAACA,CAAC,CAACoD,WAAF,CAAc,CAAd,CAAD,EAAmBpD,CAAC,CAACoD,WAAF,CAAc,CAAd,CAAnB,CALL;AAMfC,IAAAA,cAAc,EAAGrD,CAAD,IAAOA,CAAC,CAACE,IANV;AAOfoD,IAAAA,WAAW,EAAE,CAAC3B,WAAW,CAAC,CAAD,CAAZ,EAAiBA,WAAW,CAAC,CAAD,CAA5B,CAPE;AAQf4B,IAAAA,eAAe,EAAE,CACf5B,WAAW,CAAC,CAAD,CAAX,GAAiB,GAAjB,GAAuBA,WAAW,CAAC,CAAD,CAAX,GAAiB,GADzB,EAEfA,WAAW,CAAC,CAAD,CAAX,GAAiB,GAAjB,GAAuBA,WAAW,CAAC,CAAD,CAAX,GAAiB,GAFzB,CARF;AAYf6B,IAAAA,UAAU,EAAE,CAAC9D,UAAD,CAZG;AAaf+D,IAAAA,eAAe,EAAEnC,UAAU,CAAC,CAAD,CAbZ;AAcfoC,IAAAA,eAAe,EAAEpC,UAAU,CAAC,CAAD,CAdZ;AAefP,IAAAA,YAfe;AAgBfrD,IAAAA,SAhBe;AAiBfoD,IAAAA;AAjBe,GAAjB,CADJ,GAoBIkC,OAAO,KAAK,SAAZ,GACA,IAAIxG,YAAJ,CAAiB;AACfyG,IAAAA,EAAE,EAAE,SADW;AAEfrE,IAAAA,UAFe;AAGfqC,IAAAA,QAHe;AAIfxB,IAAAA,IAJe;AAKfkE,IAAAA,cAAc,EAAE,CAAC,CAAD,EAAI,GAAJ,CALD;AAMfC,IAAAA,cAAc,EAAEnE,IAAI,IAAIA,IAAI,CAACL,MAAb,GAAsB,EAAtB,GAA2B,CAN5B;AAOfyE,IAAAA,QAAQ,EAAE,IAPK;AAQfV,IAAAA,WAAW,EAAGnD,CAAD,IAAO,CAACA,CAAC,CAACoD,WAAF,CAAc,CAAd,CAAD,EAAmBpD,CAAC,CAACoD,WAAF,CAAc,CAAd,CAAnB,CARL;AASfF,IAAAA,QAAQ,EAAE,IATK;AAUfY,IAAAA,MAAM,EAAE,GAVO;AAWfL,IAAAA,eAAe,EAAEnC,UAAU,CAAC,CAAD,CAXZ;AAYfoC,IAAAA,eAAe,EAAEpC,UAAU,CAAC,CAAD,CAZZ;AAafvD,IAAAA,QAbe;AAefgG,IAAAA,WAAW,EAAE;AACXH,MAAAA,cAAc,EAAE;AADL;AAfE,GAAjB,CADA,GAoBA,IAzCS,CAAf;AA4CA,QAAMI,UAAU,GAAG,MAAnB;AAEA,sBACE;AACE,IAAA,SAAS,EAAC,WADZ;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,MAAM,EAAE,OAAV;AAAmBC,MAAAA,KAAK,EAAE,OAA1B;AAAmCC,MAAAA,OAAO,EAAE,CAA5C;AAA+CC,MAAAA,MAAM,EAAE;AAAvD,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAIE;AACE,IAAA,KAAK,EAAE;AACLC,MAAAA,eAAe,EAAE,OADZ;AAELC,MAAAA,MAAM,EAAE,MAFH;AAGL1G,MAAAA,QAAQ,EAAE,UAHL;AAIL2G,MAAAA,SAAS,EAAE,MAJN;AAKLC,MAAAA,KAAK,EAAE,MALF;AAMLC,MAAAA,OAAO,EAAE,MANJ;AAOLC,MAAAA,aAAa,EAAE,QAPV;AAQLT,MAAAA,MAAM,EAAE,OARH;AASLC,MAAAA,KAAK,EAAE,OATF;AAULS,MAAAA,WAAW,EAAE,MAVR;AAWLC,MAAAA,YAAY,EAAE,MAXT;AAYLC,MAAAA,UAAU,EAAE;AAZP,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAgBE,oBAAC,KAAD;AAAO,IAAA,KAAK,EAAE,CAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAhBF,eAiBE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+CAjBF,eAkBE;AACE,IAAA,KAAK,EAAE;AACLJ,MAAAA,OAAO,EAAE,MADJ;AAELC,MAAAA,aAAa,EAAE,KAFV;AAGLI,MAAAA,UAAU,EAAE,QAHP;AAILC,MAAAA,cAAc,EAAE,cAJX;AAKLF,MAAAA,UAAU,EAAE;AALP,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KASG7B,OAAO,KAAK,SAAZ,GACGpE,UAAU,CAACoD,GAAX,CAAgBvE,KAAD,iBACb;AACE,IAAA,KAAK,EAAE;AACLyG,MAAAA,KAAK,EAAE,UADF;AAELD,MAAAA,MAAM,EAAE,MAFH;AAGLI,MAAAA,eAAe,EAAG,OAAM5G,KAAK,CAAC,CAAD,CAAI,KAAIA,KAAK,CAAC,CAAD,CAAI,KAAIA,KAAK,CAAC,CAAD,CAAI;AAHtD,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CADH,GAUGoB,iBAAiB,CAACmD,GAAlB,CAAuBvE,KAAD,iBACpB;AACE,IAAA,KAAK,EAAE;AACLyG,MAAAA,KAAK,EAAE,UADF;AAELD,MAAAA,MAAM,EAAE,MAFH;AAGLI,MAAAA,eAAe,EAAG,OAAM5G,KAAK,CAAC,CAAD,CAAI,KAAIA,KAAK,CAAC,CAAD,CAAI,KAAIA,KAAK,CAAC,CAAD,CAAI;AAHtD,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAnBN,CAlBF,eA+CE;AACE,IAAA,KAAK,EAAE;AACLgH,MAAAA,OAAO,EAAE,MADJ;AAELC,MAAAA,aAAa,EAAE,KAFV;AAGLI,MAAAA,UAAU,EAAE,QAHP;AAILC,MAAAA,cAAc,EAAE,eAJX;AAKLF,MAAAA,UAAU,EAAE;AALP,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBASE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBATF,eAUE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAVF,CA/CF,eA2DE;AAAK,IAAA,KAAK,EAAE;AAAEA,MAAAA,UAAU,EAAE;AAAd,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACe,GADf,eAEE;AAAG,IAAA,IAAI,EAAC,4CAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BAFF,CADF,CA3DF,eAmEE;AAAK,IAAA,KAAK,EAAE;AAAEA,MAAAA,UAAU,EAAE;AAAd,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,SAAD;AAAW,IAAA,KAAK,EAAC,QAAjB;AAA0B,IAAA,KAAK,EAAEG,aAAa,CAACvF,IAAD,CAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADF,CAnEF,EAsEGuD,OAAO,KAAK,SAAZ,gBACC;AAAK,IAAA,KAAK,EAAE;AAAE6B,MAAAA,UAAU,EAAE;AAAd,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADF,eAEE,oBAAC,MAAD;AACE,IAAA,KAAK,MADP,CAEE;AAFF;AAGE,IAAA,YAAY,EAAE,CAAC,CAAD,EAAI,GAAJ,CAHhB;AAIE,IAAA,KAAK,EAAE;AAAE,SAAG,GAAL;AAAU,WAAK;AAAf,KAJT;AAKE,IAAA,aAAa,EAAEnC,cALjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,CADD,GAWG,IAjFN,eAkFE,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAlFF,eAmFE;AACE,IAAA,KAAK,EAAE;AACL+B,MAAAA,OAAO,EAAE,MADJ;AAELC,MAAAA,aAAa,EAAE,KAFV;AAGLO,MAAAA,YAAY,EAAE,QAHT;AAILF,MAAAA,cAAc,EAAE;AAJX,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAQE,oBAAC,QAAD;AAAU,IAAA,OAAO,EAAE5C,aAAnB;AAAkC,IAAA,SAAS,EAAC,aAA5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGP,SAAS,GAAGA,SAAH,GAAe,YAD3B,oBACyC,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADzC,CADF,CARF,eAaE,oBAAC,QAAD;AAAU,IAAA,OAAO,EAAEgB,WAAnB;AAAgC,IAAA,SAAS,EAAC,aAA1C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACGI,OAAO,GAAGA,OAAH,GAAa,2BADvB,oBACoD,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADpD,CADF,CAbF,CAnFF,eAsGE;AAAK,IAAA,KAAK,EAAE;AAAE6B,MAAAA,UAAU,EAAE,MAAd;AAAsBF,MAAAA,WAAW,EAAE;AAAnC,KAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBACE,oBAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACa,GADb,eAEE;AAAG,IAAA,IAAI,EAAC,iDAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAFF,CADF,CAtGF,CAJF,eAiHE;AACE,IAAA,KAAK,EAAE;AACLL,MAAAA,MAAM,EAAE;AADH,KADT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAKE,oBAAC,MAAD;AACE,IAAA,OAAO,EAAE,CAACxG,cAAD,CADX;AAEE,IAAA,gBAAgB,EAAEM,kBAFpB;AAGE,IAAA,UAAU,EAAE,IAHd;AAIE,IAAA,MAAM,EAAE2E,MAJV;AAKE,IAAA,UAAU,EAAEjE,UALd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAOE,oBAAC,SAAD;AACE,IAAA,SAAS,MADX;AAEE,IAAA,QAAQ,EAAEkC,QAFZ;AAGE,IAAA,mBAAmB,EAAE,IAHvB;AAIE,IAAA,oBAAoB,EAAEzD,mBAJxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAPF,CALF,EAmBGmE,SAAS,IAAIsB,OAAO,KAAK,SAAzB,iBACC,oBAAC,UAAD;AACE,IAAA,GAAG,EAAEtB,SAAS,CAAC,CAAD,CADhB;AAEE,IAAA,GAAG,EAAEA,SAAS,CAAC,CAAD,CAFhB;AAGE,IAAA,KAAK,EAAEC,WAHT;AAIE,IAAA,WAAW,EAAEpB,WAJf;AAKE,IAAA,cAAc,EAAEyD,UALlB;AAME,IAAA,QAAQ,EAAEvC,SANZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IApBJ,CAjHF,CADF;AAkJD","sourcesContent":["import React, { useState, useMemo } from \"react\";\nimport \"antd/dist/antd.css\";\nimport { StaticMap } from \"react-map-gl\";\nimport DeckGL from \"@deck.gl/react\";\nimport { HeatmapLayer } from \"@deck.gl/aggregation-layers\";\nimport { AmbientLight, PointLight, LightingEffect } from \"@deck.gl/core\";\nimport { HexagonLayer } from \"@deck.gl/aggregation-layers\";\nimport { DataFilterExtension } from \"@deck.gl/extensions\";\nimport { Menu, Dropdown, Button, message, Slider } from \"antd\";\nimport { DownOutlined } from \"@ant-design/icons\";\nimport { Typography } from \"antd\";\nimport { Statistic } from \"antd\";\nimport { Divider } from \"antd\";\nimport RangeInput from \"./range-input\";\nconst { Title, Text } = Typography;\nimport Charts from './charts';\n\n// Set your mapbox access token here\nconst MAPBOX_ACCESS_TOKEN =\n  \"pk.eyJ1IjoidmVyYTFrIiwiYSI6ImNrZjZ5bWZ3YzBhNDEycWxiZHBycDFrZnoifQ.hVFCurngFTtg2R0ivt-zyg\"; // eslint-disable-line\n\nconst ambientLight = new AmbientLight({\n  color: [255, 255, 255],\n  intensity: 1.0\n});\n\nconst pointLight1 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-0.144528, 49.739968, 80000]\n});\n\nconst pointLight2 = new PointLight({\n  color: [255, 255, 255],\n  intensity: 0.8,\n  position: [-3.807751, 54.104682, 8000]\n});\n\nconst lightingEffect = new LightingEffect({ambientLight, pointLight1, pointLight2});\n\nconst material = {\n  ambient: 0.64,\n  diffuse: 0.6,\n  shininess: 32,\n  specularColor: [51, 51, 51]\n};\n\nconst INITIAL_VIEW_STATE = {\n  longitude: -1.415727,\n  latitude: 52.232395,\n  zoom: 6.6,\n  minZoom: 5,\n  maxZoom: 15,\n  pitch: 40.5,\n  bearing: -27\n};\n\nexport const colorRange = [\n  [1, 152, 189],\n  [73, 227, 206],\n  [216, 254, 181],\n  [254, 237, 177],\n  [254, 173, 84],\n  [209, 55, 78]\n];\n\nexport const heatmapColorRange = [\n  [255, 255, 178],\n  [254, 217, 118],\n  [254, 178, 76],\n  [253, 141, 60],\n  [240, 59, 32],\n  [189, 0, 38],\n];\n\nfunction getTooltip({ object }) {\n  if (!object) {\n    return null;\n  }\n  const lat = object.position[1];\n  const lng = object.position[0];\n  const count = object.points.length;\n\n  return `\\\n    Latitude: ${Number.isFinite(lat) ? lat.toFixed(6) : \"\"}\n    Longitude: ${Number.isFinite(lng) ? lng.toFixed(6) : \"\"}\n    Number of Covid-19 Infections: ${count} `;\n}\n\nfunction getCovidInfections(data) {\n  return data.length;\n}\n\nconst dataFilter = new DataFilterExtension({\n  filterSize: 1,\n  fp64: false,\n});\n\nfunction getTimeRange(data) {\n  if (!data) {\n    return null;\n  }\n  return data.reduce(\n    (range, d) => {\n      const t = d.DATE;\n\n      range[0] = Math.min(range[0], t);\n      range[1] = Math.max(range[1], t);\n      return range;\n    },\n    [Infinity, -Infinity]\n  );\n}\n\nfunction formatLabel(t) {\n  const date = new Date(t);\n  return `${date.getUTCFullYear()}/${\n    date.getUTCMonth() + 1\n  }/${date.getUTCDate()}`;\n}\n\nexport default function App({\n  intensity = 1,\n  threshold = 0.1,\n  radiusPixels = 30,\n  mapStyle = \"mapbox://styles/mapbox/dark-v9\",\n  // upperPercentile = 100,\n  coverage = 1,\n}) {\n  const [vis, setVis] = useState(\"Hexagon\");\n  const [data, setData] = useState(crimeData);\n\n  const [percentile, setPercentile] = useState([0, 100]);\n\n  const [filter, setFilter] = useState(null);\n  const timeRange = useMemo(() => getTimeRange(data), [data]);\n  const filterValue = filter || timeRange;\n\n  const [crimeType, setCrimeType] = useState(null);\n  const uniqueCrimeTypes = [...new Set(crimeData.map((crime) => crime.TYPE))];\n  const crimeTypeMenu = (\n    <Menu onClick={handleMenuClick}>\n      {uniqueCrimeTypes.map((type, index) => (\n        <Menu.Item key={index}>{type}</Menu.Item>\n      ))}\n      <Menu.Item key=\"ALL\">All Crimes</Menu.Item>\n    </Menu>\n  );\n\n  function handleMenuClick(e) {\n    if (e.key === \"ALL\") {\n      setCrimeType(\"ALL\");\n      setData(crimeData);\n      message.success(\"Showing all crimes\", 1);\n    } else {\n      setCrimeType(uniqueCrimeTypes[e.key]);\n      setData(\n        crimeData.filter((crime) => crime.TYPE === uniqueCrimeTypes[e.key])\n      );\n      message.success(\"Selected \" + uniqueCrimeTypes[e.key], 1);\n    }\n  }\n\n  function onSliderChange(value) {\n    setPercentile(value);\n  }\n\n  const vizTypeMenu = (\n    <Menu onClick={handleVizChange}>\n      <Menu.Item key=\"Hexagon\">Hexagon</Menu.Item>\n      <Menu.Item key=\"Heatmap\">Heatmap</Menu.Item>\n    </Menu>\n  );\n\n  function handleVizChange(e) {\n    setVizType(e.key);\n    message.success(\"Selected \" + e.key, 1);\n  }\n\n  const layers = [\n    data && vizType === \"Heatmap\"\n      ? new HeatmapLayer({\n          data,\n          colorRange: heatmapColorRange,\n          id: \"heatmp-layer\",\n          pickable: true,\n          getPosition: (d) => [d.COORDINATES[1], d.COORDINATES[0]],\n          getFilterValue: (d) => d.DATE,\n          filterRange: [filterValue[0], filterValue[1]],\n          filterSoftRange: [\n            filterValue[0] * 0.9 + filterValue[1] * 0.1,\n            filterValue[0] * 0.1 + filterValue[1] * 0.9,\n          ],\n          extensions: [dataFilter],\n          upperPercentile: percentile[1],\n          lowerPercentile: percentile[0],\n          radiusPixels,\n          intensity,\n          threshold,\n        })\n      : vizType === \"Hexagon\"\n      ? new HexagonLayer({\n          id: \"hexagon\",\n          colorRange,\n          coverage,\n          data,\n          elevationRange: [0, 200],\n          elevationScale: data && data.length ? 50 : 0,\n          extruded: true,\n          getPosition: (d) => [d.COORDINATES[1], d.COORDINATES[0]],\n          pickable: true,\n          radius: 100,\n          upperPercentile: percentile[1],\n          lowerPercentile: percentile[0],\n          material,\n\n          transitions: {\n            elevationScale: 1000,\n          },\n        })\n      : null,\n  ];\n\n  const MS_PER_DAY = 8.64e7;\n\n  return (\n    <div\n      className=\"container\"\n      style={{ height: \"100vh\", width: \"100vw\", padding: 0, margin: 0 }}\n    >\n      <div\n        style={{\n          backgroundColor: \"white\",\n          zIndex: \"1000\",\n          position: \"absolute\",\n          marginTop: \"1.0%\",\n          right: \"1.5%\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          height: \"470px\",\n          width: \"340px\",\n          paddingLeft: \"20px\",\n          paddingRight: \"20px\",\n          paddingTop: \"12px\",\n        }}\n      >\n        <Title level={4}>Atlanta Crime Dashboard</Title>\n        <Text>All reported crimes in Atlanta in 2019.</Text>\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            alignItems: \"center\",\n            justifyContent: \"space-evenly\",\n            paddingTop: \"16px\",\n          }}\n        >\n          {vizType === \"Hexagon\"\n            ? colorRange.map((color) => (\n                <div\n                  style={{\n                    width: \"16.6667%\",\n                    height: \"18px\",\n                    backgroundColor: `rgb(${color[0]}, ${color[1]}, ${color[2]})`,\n                  }}\n                />\n              ))\n            : heatmapColorRange.map((color) => (\n                <div\n                  style={{\n                    width: \"16.6667%\",\n                    height: \"18px\",\n                    backgroundColor: `rgb(${color[0]}, ${color[1]}, ${color[2]})`,\n                  }}\n                />\n              ))}\n        </div>\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            alignItems: \"center\",\n            justifyContent: \"space-between\",\n            paddingTop: \"6px\",\n          }}\n        >\n          <Text>Fewer crimes</Text>\n          <Text>More crimes</Text>\n        </div>\n        <div style={{ paddingTop: \"12px\" }}>\n          <Text>\n            Data source:{\" \"}\n            <a href=\"http://opendata.atlantapd.org/Default.aspx\">\n              APD Open Data Portal\n            </a>\n          </Text>\n        </div>\n        <div style={{ paddingTop: \"12px\" }}>\n          <Statistic title=\"Crimes\" value={getCrimeCount(data)} />\n        </div>\n        {vizType === \"Hexagon\" ? (\n          <div style={{ paddingTop: \"12px\" }}>\n            <Text>Filter by percentile</Text>\n            <Slider\n              range\n              // tooltipVisible\n              defaultValue={[0, 100]}\n              marks={{ 0: \"0\", 100: \"100\" }}\n              onAfterChange={onSliderChange}\n            />\n          </div>\n        ) : null}\n        <Divider />\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"row\",\n            alignContent: \"center\",\n            justifyContent: \"space-around\",\n          }}\n        >\n          <Dropdown overlay={crimeTypeMenu} placement=\"bottomRight\">\n            <Button>\n              {crimeType ? crimeType : \"Crime type\"} <DownOutlined />\n            </Button>\n          </Dropdown>\n          <Dropdown overlay={vizTypeMenu} placement=\"bottomRight\">\n            <Button>\n              {vizType ? vizType : \"Choose visualization type\"} <DownOutlined />\n            </Button>\n          </Dropdown>\n        </div>\n        <div style={{ paddingTop: \"24px\", paddingLeft: \"60%\" }}>\n          <Text>\n            View Code:{\" \"}\n            <a href=\"https://github.com/forensx/atlanta_pd_dashboard\">GitHub</a>\n          </Text>\n        </div>\n      </div>\n      <div\n        style={{\n          zIndex: \"-1\",\n        }}\n      >\n        <DeckGL\n          effects={[lightingEffect]}\n          initialViewState={INITIAL_VIEW_STATE}\n          controller={true}\n          layers={layers}\n          getTooltip={getTooltip}\n        >\n          <StaticMap\n            reuseMaps\n            mapStyle={mapStyle}\n            preventStyleDiffing={true}\n            mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\n          />\n        </DeckGL>\n        {timeRange && vizType === \"Heatmap\" && (\n          <RangeInput\n            min={timeRange[0]}\n            max={timeRange[1]}\n            value={filterValue}\n            formatLabel={formatLabel}\n            animationSpeed={MS_PER_DAY}\n            onChange={setFilter}\n          />\n        )}\n      </div>\n    </div>\n  );\n}"]},"metadata":{},"sourceType":"module"}